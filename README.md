<!-- Code generated by gomarkdoc. DO NOT EDIT -->

# cmd

```go
import "github.com/leenzstra/activation_service/cmd"
```

## Index



# utils

```go
import "github.com/leenzstra/activation_service/internal/utils"
```

## Index

- [func WrapResponse(result bool, message string, data interface{}) *responses.ResponseBase](<#func-wrapresponse>)


## func WrapResponse

```go
func WrapResponse(result bool, message string, data interface{}) *responses.ResponseBase
```

# responses

```go
import "github.com/leenzstra/activation_service/internal/responses"
```

## Index

- [type LicenseDuration](<#type-licenseduration>)
  - [func (d *LicenseDuration) FromString(period string) error](<#func-licenseduration-fromstring>)
  - [func (d *LicenseDuration) MarshalJSON() ([]byte, error)](<#func-licenseduration-marshaljson>)
  - [func (d *LicenseDuration) UnmarshalJSON(data []byte) error](<#func-licenseduration-unmarshaljson>)
- [type ResponseBase](<#type-responsebase>)


## type LicenseDuration

```go
type LicenseDuration struct {
    Years  int
    Months int
    Days   int
}
```

### func \(\*LicenseDuration\) FromString

```go
func (d *LicenseDuration) FromString(period string) error
```

### func \(\*LicenseDuration\) MarshalJSON

```go
func (d *LicenseDuration) MarshalJSON() ([]byte, error)
```

### func \(\*LicenseDuration\) UnmarshalJSON

```go
func (d *LicenseDuration) UnmarshalJSON(data []byte) error
```

## type ResponseBase

```go
type ResponseBase struct {
    Result  bool        `json:"result"`
    Data    interface{} `json:"data"`
    Message string      `json:"message"`
}
```

# models

```go
import "github.com/leenzstra/activation_service/internal/models"
```

## Index

- [type License](<#type-license>)
- [type LicenseUse](<#type-licenseuse>)
- [type Subject](<#type-subject>)
- [type SubjectClass](<#type-subjectclass>)


## type License

```go
type License struct {
    gorm.Model
    Key            string `gorm:"unique"`
    MaxUses        int
    Contacts       string
    LicenseUses    []*LicenseUse
    SubjectClasses []*SubjectClass `gorm:"many2many:license_subject_classes;"`
    Period         string
}
```

## type LicenseUse

```go
type LicenseUse struct {
    gorm.Model
    LicenseID       uint
    Expiration      time.Time
    MachineInfoHash string
}
```

## type Subject

```go
type Subject struct {
    gorm.Model
    Sid            int `gorm:"unique"`
    Name           string
    Alias          string `gorm:"unique"`
    SubjectClasses []*SubjectClass
}
```

## type SubjectClass

```go
type SubjectClass struct {
    gorm.Model
    SubjectID uint
    Class     string
}
```

# access

```go
import "github.com/leenzstra/activation_service/internal/middlewares/access"
```

## Index

- [func New(config ...Config) fiber.Handler](<#func-new>)
- [type Config](<#type-config>)


## func New

```go
func New(config ...Config) fiber.Handler
```

## type Config

```go
type Config struct {
    Filter func(c *fiber.Ctx) bool // Required

    Unauthorized   fiber.Handler // middleware specfic
    Validator      func(*fiber.Ctx) (bool, error)
    SuccessHandler fiber.Handler
    ErrorHandler   fiber.ErrorHandler
}
```

# keypair

```go
import "github.com/leenzstra/activation_service/internal/keypair"
```

## Index

- [type KeyPair](<#type-keypair>)
  - [func New(pub *lk.PublicKey, private *lk.PrivateKey) *KeyPair](<#func-new>)


## type KeyPair

```go
type KeyPair struct {
    Public  *lk.PublicKey
    Private *lk.PrivateKey
}
```

### func New

```go
func New(pub *lk.PublicKey, private *lk.PrivateKey) *KeyPair
```

# db

```go
import "github.com/leenzstra/activation_service/internal/db"
```

## Index

- [type Database](<#type-database>)
  - [func New(config config.Config) *Database](<#func-new>)
  - [func (d Database) AddLicense(license *models.License) error](<#func-database-addlicense>)
  - [func (d Database) AddLicenseUse(use *models.LicenseUse) error](<#func-database-addlicenseuse>)
  - [func (d Database) GetLicenseByKey(key string) (*models.License, error)](<#func-database-getlicensebykey>)
  - [func (d Database) GetLicenseUse(key, machineInfoHash string) (*models.LicenseUse, error)](<#func-database-getlicenseuse>)
  - [func (d Database) GetLicenses() ([]*models.License, error)](<#func-database-getlicenses>)
  - [func (d Database) GetSubjectClasses(sid int, classes []string) ([]*models.SubjectClass, error)](<#func-database-getsubjectclasses>)
  - [func (d Database) GetSubjects() ([]*models.Subject, error)](<#func-database-getsubjects>)
  - [func (d Database) GetSubjectsById(ids ...uint) ([]*models.Subject, error)](<#func-database-getsubjectsbyid>)
  - [func (d Database) GetSubjectsBySid(sids ...int) ([]*models.Subject, error)](<#func-database-getsubjectsbysid>)
  - [func (d Database) InitSubjectsInfo(sc *config.SubjectsConfig) error](<#func-database-initsubjectsinfo>)


## type Database

```go
type Database struct {
    Gorm   *gorm.DB
    Config *config.Config
}
```

### func New

```go
func New(config config.Config) *Database
```

### func \(Database\) AddLicense

```go
func (d Database) AddLicense(license *models.License) error
```

### func \(Database\) AddLicenseUse

```go
func (d Database) AddLicenseUse(use *models.LicenseUse) error
```

### func \(Database\) GetLicenseByKey

```go
func (d Database) GetLicenseByKey(key string) (*models.License, error)
```

### func \(Database\) GetLicenseUse

```go
func (d Database) GetLicenseUse(key, machineInfoHash string) (*models.LicenseUse, error)
```

### func \(Database\) GetLicenses

```go
func (d Database) GetLicenses() ([]*models.License, error)
```

### func \(Database\) GetSubjectClasses

```go
func (d Database) GetSubjectClasses(sid int, classes []string) ([]*models.SubjectClass, error)
```

### func \(Database\) GetSubjects

```go
func (d Database) GetSubjects() ([]*models.Subject, error)
```

### func \(Database\) GetSubjectsById

```go
func (d Database) GetSubjectsById(ids ...uint) ([]*models.Subject, error)
```

### func \(Database\) GetSubjectsBySid

```go
func (d Database) GetSubjectsBySid(sids ...int) ([]*models.Subject, error)
```

### func \(Database\) InitSubjectsInfo

```go
func (d Database) InitSubjectsInfo(sc *config.SubjectsConfig) error
```

# config

```go
import "github.com/leenzstra/activation_service/internal/config"
```

## Index

- [type Config](<#type-config>)
  - [func LoadConfig(prod bool) (c Config, err error)](<#func-loadconfig>)
- [type SubjectsConfig](<#type-subjectsconfig>)
  - [func LoadSubjectsConfig() (c SubjectsConfig, err error)](<#func-loadsubjectsconfig>)


## type Config

```go
type Config struct {
    DBLogin    string `mapstructure:"DB_LOGIN"`
    DBPassword string `mapstructure:"DB_PASSWORD"`
    DBPath     string `mapstructure:"DB_PATH"`
    ApiKey     string `mapstructure:"API_KEY"`
}
```

### func LoadConfig

```go
func LoadConfig(prod bool) (c Config, err error)
```

## type SubjectsConfig

```go
type SubjectsConfig struct {
    Subjects []struct {
        Id      int      `yaml:"id"`
        Sid     int      `yaml:"sid"`
        Name    string   `yaml:"name"`
        Alias   string   `yaml:"alias"`
        Classes []string `yaml:"classes"`
    } `yaml:"subjects"`
}
```

### func LoadSubjectsConfig

```go
func LoadSubjectsConfig() (c SubjectsConfig, err error)
```

# collections

```go
import "github.com/leenzstra/activation_service/internal/collections"
```

## Index

- [func Map[T, U any](ts []T, f func(T) U) []U](<#func-map>)


## func Map

```go
func Map[T, U any](ts []T, f func(T) U) []U
```

# content

```go
import "github.com/leenzstra/activation_service/internal/api/content"
```

## Index

- [func RegisterRoutes(app *fiber.App, db *db.Database)](<#func-registerroutes>)


## func RegisterRoutes

```go
func RegisterRoutes(app *fiber.App, db *db.Database)
```

# info

```go
import "github.com/leenzstra/activation_service/internal/api/info"
```

## Index

- [func RegisterRoutes(app *fiber.App, db *db.Database)](<#func-registerroutes>)
- [type SubjectResponse](<#type-subjectresponse>)


## func RegisterRoutes

```go
func RegisterRoutes(app *fiber.App, db *db.Database)
```

## type SubjectResponse

```go
type SubjectResponse struct {
    Sid     int      `json:"sid"`
    Name    string   `json:"name"`
    Alias   string   `json:"alias"`
    Classes []string `json:"classes"`
}
```

# license

```go
import "github.com/leenzstra/activation_service/internal/api/license"
```

## Index

- [Variables](<#variables>)
- [func RegisterRoutes(app *fiber.App, db *db.Database, keyPair *keypair.KeyPair)](<#func-registerroutes>)
- [type AddKeyBody](<#type-addkeybody>)
- [type LicenseActivationBody](<#type-licenseactivationbody>)
- [type LicenseBody](<#type-licensebody>)
- [type LicenseInfoResponse](<#type-licenseinforesponse>)
- [type LicenseResponse](<#type-licenseresponse>)
- [type LicenseUseResponse](<#type-licenseuseresponse>)
- [type LicenseVerificationBody](<#type-licenseverificationbody>)
- [type SubjectInfo](<#type-subjectinfo>)
- [type SubjectInfoResponse](<#type-subjectinforesponse>)
- [type VerifiedBody](<#type-verifiedbody>)


## Variables

```go
var (
    ErrLicenseCreation = errors.New("ошибка при создании лицензии")
)
```

## func RegisterRoutes

```go
func RegisterRoutes(app *fiber.App, db *db.Database, keyPair *keypair.KeyPair)
```

## type AddKeyBody

```go
type AddKeyBody struct {
    Key          string        `json:"key"`
    MaxUses      int           `json:"max_uses"`
    Contacts     string        `json:"contacts"`
    Period       string        `json:"period"`
    SubjectsData []SubjectInfo `json:"subjects_data"`
}
```

## type LicenseActivationBody

```go
type LicenseActivationBody struct {
    Key             string `json:"key"`
    MachineInfoHash string `json:"machine_info_hash"`
}
```

## type LicenseBody

```go
type LicenseBody struct {
    Key             string    `json:"key"`
    MachineInfoHash string    `json:"machine_info_hash"`
    Expiration      time.Time `json:"expiration"`
}
```

## type LicenseInfoResponse

```go
type LicenseInfoResponse struct {
    Key          string                 `json:"key"`
    MaxUses      int                    `json:"max_uses"`
    Contacts     string                 `json:"contacts"`
    Period       string                 `json:"period"`
    LicenseUses  []*LicenseUseResponse  `json:"uses"`
    SubjectsInfo []*SubjectInfoResponse `json:"subjects_info"`
}
```

## type LicenseResponse

```go
type LicenseResponse struct {
    Key      string `json:"key"`
    MaxUses  int    `json:"max_uses"`
    Contacts string `json:"contacts"`
    Period   string `json:"period"`
    Uses     int    `json:"uses"`
}
```

## type LicenseUseResponse

```go
type LicenseUseResponse struct {
    MachineInfoHash string    `json:"machine_info_hash"`
    Expiration      time.Time `json:"expiration"`
}
```

## type LicenseVerificationBody

```go
type LicenseVerificationBody struct {
    LicenseHash     string `json:"license_hash"`
    MachineInfoHash string `json:"machine_info_hash"`
}
```

## type SubjectInfo

```go
type SubjectInfo struct {
    Sid     int      `json:"sid"`
    Classes []string `json:"classes"`
}
```

## type SubjectInfoResponse

```go
type SubjectInfoResponse struct {
    Sid     uint     `json:"sid"`
    Name    string   `json:"name"`
    Alias   string   `json:"alias"`
    Classes []string `json:"classes"`
}
```

## type VerifiedBody

```go
type VerifiedBody struct {
    Status int `json:"status"`
}
```



Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)
