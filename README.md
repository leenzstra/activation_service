<!-- Code generated by gomarkdoc. DO NOT EDIT -->

<h1>cmd</h1>

<p><code>go
import "github.com/leenzstra/activation_service/cmd"
</code></p>

<h2>Index</h2>

<h1>utils</h1>

<p><code>go
import "github.com/leenzstra/activation_service/internal/utils"
</code></p>

<h2>Index</h2>

<ul>
<li><a href="#func-wrapresponse">func WrapResponse(result bool, message string, data interface{}) *responses.ResponseBase</a></li>
</ul>

<h2>func WrapResponse</h2>

<p><code>go
func WrapResponse(result bool, message string, data interface{}) *responses.ResponseBase
</code></p>

<h1>responses</h1>

<p><code>go
import "github.com/leenzstra/activation_service/internal/responses"
</code></p>

<h2>Index</h2>

<ul>
<li><a href="#type-licenseduration">type LicenseDuration</a>
<ul>
<li><a href="#func-licenseduration-fromstring">func (d *LicenseDuration) FromString(period string) error</a></li>
<li><a href="#func-licenseduration-marshaljson">func (d *LicenseDuration) MarshalJSON() ([]byte, error)</a></li>
<li><a href="#func-licenseduration-unmarshaljson">func (d *LicenseDuration) UnmarshalJSON(data []byte) error</a></li>
</ul></li>
<li><a href="#type-responsebase">type ResponseBase</a></li>
</ul>

<h2>type LicenseDuration</h2>

<p><code>go
type LicenseDuration struct {
    Years  int
    Months int
    Days   int
}
</code></p>

<h3>func (*LicenseDuration) FromString</h3>

<p><code>go
func (d *LicenseDuration) FromString(period string) error
</code></p>

<h3>func (*LicenseDuration) MarshalJSON</h3>

<p><code>go
func (d *LicenseDuration) MarshalJSON() ([]byte, error)
</code></p>

<h3>func (*LicenseDuration) UnmarshalJSON</h3>

<p><code>go
func (d *LicenseDuration) UnmarshalJSON(data []byte) error
</code></p>

<h2>type ResponseBase</h2>

<p><code>go
type ResponseBase struct {
    Result  bool        `json:"result"`
    Data    interface{} `json:"data"`
    Message string      `json:"message"`
}
</code></p>

<h1>models</h1>

<p><code>go
import "github.com/leenzstra/activation_service/internal/models"
</code></p>

<h2>Index</h2>

<ul>
<li><a href="#type-license">type License</a></li>
<li><a href="#type-licenseuse">type LicenseUse</a></li>
<li><a href="#type-subject">type Subject</a></li>
<li><a href="#type-subjectclass">type SubjectClass</a></li>
</ul>

<h2>type License</h2>

<p><code>go
type License struct {
    gorm.Model
    Key            string `gorm:"unique"`
    MaxUses        int
    Contacts       string
    LicenseUses    []*LicenseUse
    SubjectClasses []*SubjectClass `gorm:"many2many:license_subject_classes;"`
    Period         string
}
</code></p>

<h2>type LicenseUse</h2>

<p><code>go
type LicenseUse struct {
    gorm.Model
    LicenseID       uint
    Expiration      time.Time
    MachineInfoHash string
}
</code></p>

<h2>type Subject</h2>

<p><code>go
type Subject struct {
    gorm.Model
    Sid            int `gorm:"unique"`
    Name           string
    Alias          string `gorm:"unique"`
    SubjectClasses []*SubjectClass
}
</code></p>

<h2>type SubjectClass</h2>

<p><code>go
type SubjectClass struct {
    gorm.Model
    SubjectID uint
    Class     string
}
</code></p>

<h1>access</h1>

<p><code>go
import "github.com/leenzstra/activation_service/internal/middlewares/access"
</code></p>

<h2>Index</h2>

<ul>
<li><a href="#func-new">func New(config ...Config) fiber.Handler</a></li>
<li><a href="#type-config">type Config</a></li>
</ul>

<h2>func New</h2>

<p><code>go
func New(config ...Config) fiber.Handler
</code></p>

<h2>type Config</h2>

<p>```go
type Config struct {
    Filter func(c *fiber.Ctx) bool // Required</p>

<pre><code>Unauthorized   fiber.Handler // middleware specfic
Validator      func(*fiber.Ctx) (bool, error)
SuccessHandler fiber.Handler
ErrorHandler   fiber.ErrorHandler
</code></pre>

<p>}
```</p>

<h1>keypair</h1>

<p><code>go
import "github.com/leenzstra/activation_service/internal/keypair"
</code></p>

<h2>Index</h2>

<ul>
<li><a href="#type-keypair">type KeyPair</a>
<ul>
<li><a href="#func-new">func New(pub *lk.PublicKey, private *lk.PrivateKey) *KeyPair</a></li>
</ul></li>
</ul>

<h2>type KeyPair</h2>

<p><code>go
type KeyPair struct {
    Public  *lk.PublicKey
    Private *lk.PrivateKey
}
</code></p>

<h3>func New</h3>

<p><code>go
func New(pub *lk.PublicKey, private *lk.PrivateKey) *KeyPair
</code></p>

<h1>db</h1>

<p><code>go
import "github.com/leenzstra/activation_service/internal/db"
</code></p>

<h2>Index</h2>

<ul>
<li><a href="#type-database">type Database</a>
<ul>
<li><a href="#func-new">func New(config config.Config) <em>Database</a></li>
<li><a href="#func-database-addlicense">func (d Database) AddLicense(license *models.License) error</a></li>
<li><a href="#func-database-addlicenseuse">func (d Database) AddLicenseUse(use *models.LicenseUse) error</a></li>
<li><a href="#func-database-getlicensebykey">func (d Database) GetLicenseByKey(key string) (</em>models.License, error)</a></li>
<li><a href="#func-database-getlicenseuse">func (d Database) GetLicenseUse(key, machineInfoHash string) (<em>models.LicenseUse, error)</a></li>
<li><a href="#func-database-getlicenses">func (d Database) GetLicenses() ([]</em>models.License, error)</a></li>
<li><a href="#func-database-getsubjectclasses">func (d Database) GetSubjectClasses(sid int, classes []string) ([]<em>models.SubjectClass, error)</a></li>
<li><a href="#func-database-getsubjects">func (d Database) GetSubjects() ([]</em>models.Subject, error)</a></li>
<li><a href="#func-database-getsubjectsbyid">func (d Database) GetSubjectsById(ids ...uint) ([]<em>models.Subject, error)</a></li>
<li><a href="#func-database-getsubjectsbysid">func (d Database) GetSubjectsBySid(sids ...int) ([]</em>models.Subject, error)</a></li>
<li><a href="#func-database-initsubjectsinfo">func (d Database) InitSubjectsInfo(sc *config.SubjectsConfig) error</a></li>
</ul></li>
</ul>

<h2>type Database</h2>

<p><code>go
type Database struct {
    Gorm   *gorm.DB
    Config *config.Config
}
</code></p>

<h3>func New</h3>

<p><code>go
func New(config config.Config) *Database
</code></p>

<h3>func (Database) AddLicense</h3>

<p><code>go
func (d Database) AddLicense(license *models.License) error
</code></p>

<h3>func (Database) AddLicenseUse</h3>

<p><code>go
func (d Database) AddLicenseUse(use *models.LicenseUse) error
</code></p>

<h3>func (Database) GetLicenseByKey</h3>

<p><code>go
func (d Database) GetLicenseByKey(key string) (*models.License, error)
</code></p>

<h3>func (Database) GetLicenseUse</h3>

<p><code>go
func (d Database) GetLicenseUse(key, machineInfoHash string) (*models.LicenseUse, error)
</code></p>

<h3>func (Database) GetLicenses</h3>

<p><code>go
func (d Database) GetLicenses() ([]*models.License, error)
</code></p>

<h3>func (Database) GetSubjectClasses</h3>

<p><code>go
func (d Database) GetSubjectClasses(sid int, classes []string) ([]*models.SubjectClass, error)
</code></p>

<h3>func (Database) GetSubjects</h3>

<p><code>go
func (d Database) GetSubjects() ([]*models.Subject, error)
</code></p>

<h3>func (Database) GetSubjectsById</h3>

<p><code>go
func (d Database) GetSubjectsById(ids ...uint) ([]*models.Subject, error)
</code></p>

<h3>func (Database) GetSubjectsBySid</h3>

<p><code>go
func (d Database) GetSubjectsBySid(sids ...int) ([]*models.Subject, error)
</code></p>

<h3>func (Database) InitSubjectsInfo</h3>

<p><code>go
func (d Database) InitSubjectsInfo(sc *config.SubjectsConfig) error
</code></p>

<h1>config</h1>

<p><code>go
import "github.com/leenzstra/activation_service/internal/config"
</code></p>

<h2>Index</h2>

<ul>
<li><a href="#type-config">type Config</a>
<ul>
<li><a href="#func-loadconfig">func LoadConfig(prod bool) (c Config, err error)</a></li>
</ul></li>
<li><a href="#type-subjectsconfig">type SubjectsConfig</a>
<ul>
<li><a href="#func-loadsubjectsconfig">func LoadSubjectsConfig() (c SubjectsConfig, err error)</a></li>
</ul></li>
</ul>

<h2>type Config</h2>

<p><code>go
type Config struct {
    DBLogin    string `mapstructure:"DB_LOGIN"`
    DBPassword string `mapstructure:"DB_PASSWORD"`
    DBPath     string `mapstructure:"DB_PATH"`
    ApiKey     string `mapstructure:"API_KEY"`
}
</code></p>

<h3>func LoadConfig</h3>

<p><code>go
func LoadConfig(prod bool) (c Config, err error)
</code></p>

<h2>type SubjectsConfig</h2>

<p><code>go
type SubjectsConfig struct {
    Subjects []struct {
        Id      int      `yaml:"id"`
        Sid     int      `yaml:"sid"`
        Name    string   `yaml:"name"`
        Alias   string   `yaml:"alias"`
        Classes []string `yaml:"classes"`
    } `yaml:"subjects"`
}
</code></p>

<h3>func LoadSubjectsConfig</h3>

<p><code>go
func LoadSubjectsConfig() (c SubjectsConfig, err error)
</code></p>

<h1>collections</h1>

<p><code>go
import "github.com/leenzstra/activation_service/internal/collections"
</code></p>

<h2>Index</h2>

<ul>
<li><a href="#func-map">func Map[T, U any](ts []T, f func(T) U) []U</a></li>
</ul>

<h2>func Map</h2>

<p><code>go
func Map[T, U any](ts []T, f func(T) U) []U
</code></p>

<h1>content</h1>

<p><code>go
import "github.com/leenzstra/activation_service/internal/api/content"
</code></p>

<h2>Index</h2>

<ul>
<li><a href="#func-registerroutes">func RegisterRoutes(app *fiber.App, db *db.Database)</a></li>
</ul>

<h2>func RegisterRoutes</h2>

<p><code>go
func RegisterRoutes(app *fiber.App, db *db.Database)
</code></p>

<h1>info</h1>

<p><code>go
import "github.com/leenzstra/activation_service/internal/api/info"
</code></p>

<h2>Index</h2>

<ul>
<li><a href="#func-registerroutes">func RegisterRoutes(app *fiber.App, db *db.Database)</a></li>
<li><a href="#type-subjectresponse">type SubjectResponse</a></li>
</ul>

<h2>func RegisterRoutes</h2>

<p><code>go
func RegisterRoutes(app *fiber.App, db *db.Database)
</code></p>

<h2>type SubjectResponse</h2>

<p><code>go
type SubjectResponse struct {
    Sid     int      `json:"sid"`
    Name    string   `json:"name"`
    Alias   string   `json:"alias"`
    Classes []string `json:"classes"`
}
</code></p>

<h1>license</h1>

<p><code>go
import "github.com/leenzstra/activation_service/internal/api/license"
</code></p>

<h2>Index</h2>

<ul>
<li><a href="#variables">Variables</a></li>
<li><a href="#func-registerroutes">func RegisterRoutes(app *fiber.App, db *db.Database, keyPair *keypair.KeyPair)</a></li>
<li><a href="#type-addkeybody">type AddKeyBody</a></li>
<li><a href="#type-licenseactivationbody">type LicenseActivationBody</a></li>
<li><a href="#type-licensebody">type LicenseBody</a></li>
<li><a href="#type-licenseinforesponse">type LicenseInfoResponse</a></li>
<li><a href="#type-licenseresponse">type LicenseResponse</a></li>
<li><a href="#type-licenseuseresponse">type LicenseUseResponse</a></li>
<li><a href="#type-licenseverificationbody">type LicenseVerificationBody</a></li>
<li><a href="#type-subjectinfo">type SubjectInfo</a></li>
<li><a href="#type-subjectinforesponse">type SubjectInfoResponse</a></li>
<li><a href="#type-verifiedbody">type VerifiedBody</a></li>
</ul>

<h2>Variables</h2>

<p><code>go
var (
    ErrLicenseCreation = errors.New("ошибка при создании лицензии")
)
</code></p>

<h2>func RegisterRoutes</h2>

<p><code>go
func RegisterRoutes(app *fiber.App, db *db.Database, keyPair *keypair.KeyPair)
</code></p>

<h2>type AddKeyBody</h2>

<p><code>go
type AddKeyBody struct {
    Key          string        `json:"key"`
    MaxUses      int           `json:"max_uses"`
    Contacts     string        `json:"contacts"`
    Period       string        `json:"period"`
    SubjectsData []SubjectInfo `json:"subjects_data"`
}
</code></p>

<h2>type LicenseActivationBody</h2>

<p><code>go
type LicenseActivationBody struct {
    Key             string `json:"key"`
    MachineInfoHash string `json:"machine_info_hash"`
}
</code></p>

<h2>type LicenseBody</h2>

<p><code>go
type LicenseBody struct {
    Key             string    `json:"key"`
    MachineInfoHash string    `json:"machine_info_hash"`
    Expiration      time.Time `json:"expiration"`
}
</code></p>

<h2>type LicenseInfoResponse</h2>

<p><code>go
type LicenseInfoResponse struct {
    Key          string                 `json:"key"`
    MaxUses      int                    `json:"max_uses"`
    Contacts     string                 `json:"contacts"`
    Period       string                 `json:"period"`
    LicenseUses  []*LicenseUseResponse  `json:"uses"`
    SubjectsInfo []*SubjectInfoResponse `json:"subjects_info"`
}
</code></p>

<h2>type LicenseResponse</h2>

<p><code>go
type LicenseResponse struct {
    Key      string `json:"key"`
    MaxUses  int    `json:"max_uses"`
    Contacts string `json:"contacts"`
    Period   string `json:"period"`
    Uses     int    `json:"uses"`
}
</code></p>

<h2>type LicenseUseResponse</h2>

<p><code>go
type LicenseUseResponse struct {
    MachineInfoHash string    `json:"machine_info_hash"`
    Expiration      time.Time `json:"expiration"`
}
</code></p>

<h2>type LicenseVerificationBody</h2>

<p><code>go
type LicenseVerificationBody struct {
    LicenseHash     string `json:"license_hash"`
    MachineInfoHash string `json:"machine_info_hash"`
}
</code></p>

<h2>type SubjectInfo</h2>

<p><code>go
type SubjectInfo struct {
    Sid     int      `json:"sid"`
    Classes []string `json:"classes"`
}
</code></p>

<h2>type SubjectInfoResponse</h2>

<p><code>go
type SubjectInfoResponse struct {
    Sid     uint     `json:"sid"`
    Name    string   `json:"name"`
    Alias   string   `json:"alias"`
    Classes []string `json:"classes"`
}
</code></p>

<h2>type VerifiedBody</h2>

<p><code>go
type VerifiedBody struct {
    Status int `json:"status"`
}
</code></p>

<p>Generated by <a href="https://github.com/princjef/gomarkdoc">gomarkdoc</a></p>
